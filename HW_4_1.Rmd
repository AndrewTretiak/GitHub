---
title: "HW_4_1"
author: "Andrey_Tretiak"
date: '12 октября 2016 г '
output: html_document
---
#«ЧТО СКРЫВАЕТ GOOGLE?»
##Пункт 1 (Графический анализ)

```{r google}
plot (goog)
```
 
 Можно сказать, что в тенденциях отношений между переменной complied и другими переменными есть как равномерное, так и неравномерное распределение данных. Например, отношение между comiled и requests, pop, hdi, dem. Одно из наблюдений, которое выделяется как необычное (выброс), является количество запросов к Google данных о пользователях от государственных органов и судебных инстанций для уголовных расследований(отношение comiled и requests), кроме того присутствуют очевидные выбросы в отношении с pop,hdi и internet.

##Пункт 2 (Удаляем выбросы)
```{r google}
which.max (goog$pop)
goog_sub=subset(goog, goog$country != "india")
plot (goog_sub)
```
 
 Результат функции which.max() показывает, что наблюдение в 10-й строке набора данных — страна с самой высокой численностью населения, и эта страна — Индия. 
Построим подмножество данных с исключенным наблюдением с помощью функции subset(). Другие страны необычными на этих графиках не кажутся, разве что можно сказать о том, что США немного выделяется из всех остальных стран по популяции, т.к. это вторая страна по популяции после Индии из представленных данных, а разница со страной на 3 месте (Бразилия) составляет около 120 тыс. людей.

##Пункт 3 (Определим уровень отсчета)
```{r google}
table(goog_sub$dem)
goog_sub$dem=relevel(goog_sub$dem,ref=”hybrid”)
```

 Построим частотную таблицу для переменной dem с помощью функции table(). Уровень, который показывается первым — free — является уровнем отсчета по умолчанию. 
 Поменяем уровень отсчета на hybrid, используя функцию relevel(). После вызова данной функции уровень отсчета для переменной dem был изменен на hybrid.
 
##Пункт 4 (Множественная регрессия)
```{r google}
m_full = lm (complied~requests+pop+hdi+dem+internet+ freepress, data = goog_sub)
summary (m_full)
```
 Построим модель линейной регрессии, чтобы предсказать долю удовлетворяемости запросов, используя остальную часть объясняющих переменных.
 Из столбца Pr(>|t|) (коэфициента значимости) видно,что ни одна из переменных не  является значимой, т.к. все p>0.1
 R^2 показывает, что модель объясняет 45,59 % дисперсии значений. Можно сделать вывод о том, что уравнение регрессии незначимое.
 
##Пункт 5 (Прогноз)
```{r google}
predict (m_full)
predict(m_full,newdata=new.request,interval="prediction")
```
 Используя таблицу данных, выясним какая строка соответствует US. Предсказанная доля выполненных запросов для США на основе модели составляет 94.790796% запросов, которые выполнил Google, на основе объясняющих переменных.
 
##Пункт 6 (Проверка условий Гаусса–Маркова на случайный член)
```{r google}
m_full$residuals
```
 Проанализируем остатки, которые могут быть извлечены с помощью функции m_full$residuals. 
 Связь линейная, так как рассеяние вокруг линии - абсолютный шум. При росте предсказанных значений вариабельность остатков остается константой.
 На графиках отсутствуют какие-либо очевидные причины для беспокойства по поводу распределения данных.
 
##Пункт 7 (Удаление переменной)
```{r google}
step <- stepAIC(m_full, direction="both")
```

 Проведем анализ того, как меняются коэффициенты и значение других объясняющих переменных с помощью метода пошаговой регрессии (backward).  
 Цель пошаговой регрессии состоит в отборе из большого количества предикторов небольшой подгруппы переменных, которые вносят наибольший вклад в вариацию зависимой переменной.
 Проведя данный анализ, увидим, что наиболее значимые объясняющие переменные - pop и hdi, то есть популяция и индекс развития человеческого потенциала. Значение AIC изменилось со 160.8 до 153.54, что соответствует минимально возможному значению, как раз, что нам и необходимо (нужно как можно наименьшее значение).
 Построим новую модель линейной регрессии с данными переменными. В данном случае переменная hdi является значимой (p<0.001). Кроме того, R^2 показывает, что модель объясняет 39,36 % дисперсии значений. Можно сделать вывод о том, что уравнение регрессии незначимое из-за малого количества задействованных объясняющих переменных.